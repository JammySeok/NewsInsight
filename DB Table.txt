데이터베이스 테이블
user (id, userid, password, nickname, provider, provider_id, role, create_at, update_at)
subscription (id, user_id, subscription_type, start_date, end_date, is_active)
news (id, original_url, title, content, summary, published_at, source, create_at)
category (id, name)
tag (id, name)
insight (id, title, content, domain, create_at)
news_category (news_id, category_id) / PK: news_id, category_id
news_tag (news_id, tag_id) / PK: news_id, tag_id
insight_news (insight_id, news_id) / PK: insight_id, news_id

-----------------------------

User (사용자 정보)
id (PK, BIGINT, AUTO_INCREMENT)
userid (VARCHAR, UNIQUE)
password (VARCHAR)
nickname (VARCHAR, UNIQUE)
provider (VARCHAR)  -- OAuth2 연동 고려 (local/google/kakao ...)
provider_id (VARCHAR)  -- OAuth2 제공 ID
role (VARCHAR)  -- 유저 권한 (user/admin)
create_at (DATETIME)
update_at (DATETIME)


Subscription (구독 정보)
id (PK, BIGINT, AUTO_INCREMENT)
user_id (FK from User)
subscription_type (VARCHAR)  -- 구독타입 (standard/premium)
start_date (DATETIME)  -- 구독 시작일
end_date (DATETIME)  -- 구독 종료일
is_active (BOOLEAN)  -- 구독 상황


News (뉴스 기사)
id (PK, BIGINT, AUTO_INCREMENT)
original_url (VARCHAR, UNIQUE)  -- 기사 원문 주소
title (VARCHAR)  -- 원본 제목
content (TEXT)  -- 원본 내용
summary (TEXT)  -- AI 요약 내용
published_at (DATETIME) - 기사 발행일
source (VARCHAR)  -- 언론사
create_at (DATETIME)  -- 기사를 수집해서 내 데이터베이스에 저장한 시간


Category (카테고리)
id (PK, INT, AUTO_INCREMENT)
name (VARCHAR, UNIQUE) 


Tag (태그)
id (PK, BIGINT, AUTO_INCREMENT)
name (VARCHAR, UNIQUE)


Insight (인사이트)
id (PK, BIGINT, AUTO_INCREMENT)
title (VARCHAR) 
content (TEXT) 
domain (VARCHAR)
create_at (DATETIME)




News_Category (뉴스-카테고리 연결)
news_id (FK from News)
category_id (FK from Category)
(PK: news_id, category_id)


News_Tag (뉴스-태그 연결)
news_id (FK from News)
tag_id (FK from Tag)
(PK: news_id, tag_id)


Insight_News (인사이트-뉴스 연결)
insight_id (FK from Insight)
news_id (FK from News)
(PK: insight_id, news_id)


-----------------------------


CREATE DATABASE news_insight;
use news_insight;

CREATE TABLE user (
    id BIGINT NOT NULL AUTO_INCREMENT,
    userid VARCHAR(255) NOT NULL UNIQUE,
    password VARCHAR(255) NULL,
    email VARCHAR(255) NOT NULL UNIQUE,
    nickname VARCHAR(100) NOT NULL UNIQUE,
    provider VARCHAR(50) NOT NULL DEFAULT 'local',
    provider_id VARCHAR(255) NULL,
    role VARCHAR(50) NOT NULL DEFAULT 'ROLE_USER',
    create_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    update_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;


CREATE TABLE subscription (
    id BIGINT NOT NULL AUTO_INCREMENT,
    user_id BIGINT NOT NULL,
    subscription_type VARCHAR(100) NOT NULL,
    start_date DATETIME NOT NULL,
    end_date DATETIME NOT NULL,
    is_active BOOLEAN NOT NULL DEFAULT TRUE,
    PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;


CREATE TABLE news (
    id BIGINT NOT NULL AUTO_INCREMENT,
    original_url VARCHAR(767) NOT NULL UNIQUE,
    title VARCHAR(512) NOT NULL,
    content MEDIUMTEXT NULL,
    summary TEXT NULL,
    published_at DATETIME NOT NULL,
    source VARCHAR(100) NULL,
    create_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    PRIMARY KEY (id),
    INDEX idx_published_at (published_at)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;


CREATE TABLE category (
    id INT NOT NULL AUTO_INCREMENT,
    name VARCHAR(100) NOT NULL UNIQUE,
    PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;


CREATE TABLE tag (
    id BIGINT NOT NULL AUTO_INCREMENT,
    name VARCHAR(100) NOT NULL UNIQUE,
    PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;


CREATE TABLE insight (
    id BIGINT NOT NULL AUTO_INCREMENT,
    title VARCHAR(512) NOT NULL,
    content TEXT NULL,
    domain VARCHAR(100) NOT NULL,
    create_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    PRIMARY KEY (id),
    INDEX idx_domain (domain)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;


CREATE TABLE news_category (
    news_id BIGINT NOT NULL,
    category_id INT NOT NULL,
    PRIMARY KEY (news_id, category_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;


CREATE TABLE news_tag (
    news_id BIGINT NOT NULL,
    tag_id BIGINT NOT NULL,
    PRIMARY KEY (news_id, tag_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;


CREATE TABLE insight_news (
    insight_id BIGINT NOT NULL,
    news_id BIGINT NOT NULL,
    PRIMARY KEY (insight_id, news_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;


